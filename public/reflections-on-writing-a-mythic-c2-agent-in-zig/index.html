<link rel=stylesheet href=/css/custom.css><!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en-us lang=en-us><head><link href=https://gmpg.org/xfn/11 rel=profile><meta charset=utf-8><meta name=generator content="Hugo 0.111.3"><meta name=viewport content="width=device-width,initial-scale=1"><title>Reflections on Writing a Mythic C2 Agent in Zig &#183; pop-ecx</title><meta name=description content><link type=text/css rel=stylesheet href=https://pop-ecx.github.io/css/print.css media=print><link type=text/css rel=stylesheet href=https://pop-ecx.github.io/css/poole.css><link type=text/css rel=stylesheet href=https://pop-ecx.github.io/css/syntax.css><link type=text/css rel=stylesheet href=https://pop-ecx.github.io/css/hyde.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700"><link rel=apple-touch-icon-precomposed sizes=144x144 href=/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=/favicon.png><script src=https://unpkg.com/darkmode-js@1.5.7/lib/darkmode-js.min.js></script>
<script>function addDarkmodeWidget(){new Darkmode({label:"ðŸŒ“",saveInCookies:!0,autoMatchOsTheme:!0,bottom:"32px",right:"32px",time:"0.3s",mixColor:"#fff",backgroundColor:"#fff"}).showWidget()}window.addEventListener("load",addDarkmodeWidget)</script></head><body><aside class=sidebar><div class="container sidebar-sticky"><div class=author-image><img src=/images/me.png alt="Author Image" class=author-image></div><div class=sidebar-about><a href=https://pop-ecx.github.io/><h1>pop-ecx</h1></a><p class=lead>Tech musings</p></div><div class=social-links><a href=https://github.com/pop-ecx target=_blank rel="noopener noreferrer"><img src=https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/github.svg width=24 height=24 alt=GitHub></a>
<a href=https://keybase.io/oliver_m target=_blank rel="noopener noreferrer"><img src=https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/keybase.svg width=24 height=24 alt=Keybase></a>
<a href=https://bsky.app/profile/pop-ecx.bsky.social target=_blank rel="noopener noreferrer"><img src=https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/bluesky.svg width=24 height=24 alt=Bluesky></a>
<a href=https://www.linkedin.com/in/oliver-mulwa target=_blank rel="noopener noreferrer"><img src=https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/linkedin.svg width=24 height=24 alt=LinkedIn></a></div><nav><ul class=sidebar-nav><li><a href=https://pop-ecx.github.io/>Home</a></li><li><a href=/posts/>Posts</a></li><li><a href=/about/>About</a></li></ul></nav><p>&copy; 2025. All rights reserved.</p></div></aside><main class="content container"><div class=post><h1>Reflections on Writing a Mythic C2 Agent in Zig</h1><time datetime=2025-07-14T09:38:04+0300 class=post-date>Mon, Jul 14, 2025</time><p><img src=./rango-2.png alt=avatar></p><p>Over the past couple of months, I&rsquo;ve been writing a mythic C2 implant in zig.
&ldquo;Why?&rdquo;, you ask. Well, it&rsquo;s all part of my learning process. I also
wanted to understand how C2 frameworks work and how zig can be used for offensive tooling.</p><p>There are lots of C2 frameworks out there and each has its own quirks and uniqueness.
I happened to settle on Mythic. Mythic supports agents written in any language. This helps me
improve my zig skills. Plus, the documentation is great.</p><p>The implant is simple and minimal. It supports Mythic&rsquo;s HTTP profile. The agent itself
does not support encryption at the moment. Zig does not have AES-CBC as far as I can tell.
It does have other AES modes though like GCM and OCB. There are also endless &lsquo;CBC bad&rsquo; warnings I came across.
Though it is possible to use external dependencies for AES-CBC, I chose not to because reasons.
I might just write my own implementation of the CBC mode. If I do, I&rsquo;ll probably talk about it here.</p><p>The agent is for educational purposes and is not opsec sound yet (that&rsquo;s why I have no qualms putting it in the public domain).</p><p>You can find <a href=https://github.com/pop-ecx/rango.git>my zig agent</a> here.</p><p>Below are some super useful resources</p><ul><li><a href=https://docs.mythic-c2.net/>Mythic docs</a></li><li><a href=https://red-team-sncf.github.io/how-to-create-your-own-mythic-agent-in-c.html>C-based Mythic agent tutorial</a></li></ul></div></main></body></html>