<link rel=stylesheet href=/css/custom.css><!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en-us lang=en-us><head><link href=https://gmpg.org/xfn/11 rel=profile><meta charset=utf-8><meta name=generator content="Hugo 0.111.3"><meta name=viewport content="width=device-width,initial-scale=1"><title>pop-ecx</title><meta name=description content="Tech musings"><link type=text/css rel=stylesheet href=https://pop-ecx.github.io/css/print.css media=print><link type=text/css rel=stylesheet href=https://pop-ecx.github.io/css/poole.css><link type=text/css rel=stylesheet href=https://pop-ecx.github.io/css/syntax.css><link type=text/css rel=stylesheet href=https://pop-ecx.github.io/css/hyde.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700"><link rel=apple-touch-icon-precomposed sizes=144x144 href=/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=/favicon.png><link href=https://pop-ecx.github.io/index.xml rel=alternate type=application/rss+xml title=pop-ecx><script src=https://unpkg.com/darkmode-js@1.5.7/lib/darkmode-js.min.js></script>
<script>function addDarkmodeWidget(){new Darkmode({label:"ðŸŒ“",saveInCookies:!0,autoMatchOsTheme:!0,bottom:"32px",right:"32px",time:"0.3s",mixColor:"#fff",backgroundColor:"#fff"}).showWidget()}window.addEventListener("load",addDarkmodeWidget)</script></head><body><aside class=sidebar><div class="container sidebar-sticky"><div class=author-image><img src=/images/me.png alt="Author Image" class=author-image></div><div class=sidebar-about><a href=https://pop-ecx.github.io/><h1>pop-ecx</h1></a><p class=lead>Tech musings</p></div><div class=social-links><a href=https://github.com/pop-ecx target=_blank rel="noopener noreferrer"><img src=https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/github.svg width=24 height=24 alt=GitHub></a>
<a href=https://keybase.io/oliver_m target=_blank rel="noopener noreferrer"><img src=https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/keybase.svg width=24 height=24 alt=Keybase></a>
<a href=https://bsky.app/profile/pop-ecx.bsky.social target=_blank rel="noopener noreferrer"><img src=https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/bluesky.svg width=24 height=24 alt=Bluesky></a>
<a href=https://www.linkedin.com/in/oliver-mulwa target=_blank rel="noopener noreferrer"><img src=https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/linkedin.svg width=24 height=24 alt=LinkedIn></a></div><nav><ul class=sidebar-nav><li><a href=https://pop-ecx.github.io/>Home</a></li><li><a href=/posts/>Posts</a></li><li><a href=/about/>About</a></li></ul></nav><p>&copy; 2026. All rights reserved.</p></div></aside><main class="content container"><div class=posts><article class=post><h1 class=post-title><a href=https://pop-ecx.github.io/writing-custom-wazuh-rules/>Writing Custom Wazuh Rules</a></h1><time datetime=2026-01-22T15:48:20+0300 class=post-date>Thu, Jan 22, 2026</time><br>Wazuh is a powerful open-source security monitoring platform that acts as a SIEM/XDR solution. Though it has some shortcomings, it has tons of strengths, my favorite ones being; its customizability and its open-source nature. This article will be more or less a tutorial on how to write a simple custom wazuh rule to detect potential port scans on a monitored host.
The setup is as follows:
Wazuh manager (4.14.1) running on a Linux VM.<div class=read-more-link><a href=/writing-custom-wazuh-rules/>Read Moreâ€¦</a></div></article><article class=post><h1 class=post-title><a href=https://pop-ecx.github.io/safety-in-zig-how-debug-allocator-works/>Safety in Zig: How Debug Allocator Works</a></h1><time datetime=2026-01-06T10:55:00+0300 class=post-date>Tue, Jan 6, 2026</time><br>Zig is not a memory-safe language. It, however, provides some tools to help avoid some memory safety issues. One of the key tools that help achieve this is the debug allocator. The debug allocator is a special memory allocator that tracks memory allocations and deallocations, helping identify memory leaks and other memory-related issues during development.
Since zig isn&rsquo;t a GC language and does not have a borrow checker, partly due to its design goals, the debug allocator plays a crucial role in helping avoid some memory safety issues.<div class=read-more-link><a href=/safety-in-zig-how-debug-allocator-works/>Read Moreâ€¦</a></div></article><article class=post><h1 class=post-title><a href=https://pop-ecx.github.io/painless-guide-to-linux-in-memory-execution/>Painless Guide to Linux in-Memory Execution</a></h1><time datetime=2025-12-04T08:21:15+0300 class=post-date>Thu, Dec 4, 2025</time><br>In-memory execution, a technique that allows programs to be run directly from memory without being written to disk. Over the past few weeks, I&rsquo;ve been attempting to learn and understand this concept better. In a previous post, I explained my reasoning behind choosing ZYRA for obfuscation and packing. The key reason behind I could take it to whichever direction I wanted, should need arise.
Safe to say, need did arise. So in this post, we&rsquo;ll modify ZYRA to support in-memory execution.<div class=read-more-link><a href=/painless-guide-to-linux-in-memory-execution/>Read Moreâ€¦</a></div></article><article class=post><h1 class=post-title><a href=https://pop-ecx.github.io/zig-as-a-drop-in-c-replacement/>Zig as a drop-in replacement for C build systems</a></h1><time datetime=2025-10-21T09:28:15+0300 class=post-date>Tue, Oct 21, 2025</time><br>A while back I wrote a small neofetch-like program in Zig as a way to learn the language. I always knew Zig could interoperate with C, as I had earlier written a yara rules parser using treesitter and Zig.
Now I wanted to test my neofetch-like program in various environments, and one of those was st. St is a simple terminal emulator, part of the suckless tools. It is written in C, minimalistic and I generally liked using it.<div class=read-more-link><a href=/zig-as-a-drop-in-c-replacement/>Read Moreâ€¦</a></div></article><article class=post><h1 class=post-title><a href=https://pop-ecx.github.io/pack-to-the-futureobfuscating-my-c2-agent/>Pack to the Future:obfuscating My C2 Agent</a></h1><time datetime=2025-09-09T12:56:16+0300 class=post-date>Tue, Sep 9, 2025</time><br>This is a follow up on my previous article.
It is generally about my journey in searching for a relatively unknown and easy to understand packer to obfuscate my custom zig C2 agent. If you are generally looking for a tutorial on how to pack binaries, this is not it. I will not go into the details of how packers work, but rather share what led me to the final solution.<div class=read-more-link><a href=/pack-to-the-futureobfuscating-my-c2-agent/>Read Moreâ€¦</a></div></article><article class=post><h1 class=post-title><a href=https://pop-ecx.github.io/reflections-on-writing-a-mythic-c2-agent-in-zig/>Reflections on Writing a Mythic C2 Agent in Zig</a></h1><time datetime=2025-07-14T09:38:04+0300 class=post-date>Mon, Jul 14, 2025</time><br>Over the past couple of months, I&rsquo;ve been writing a mythic C2 implant in zig. &ldquo;Why?&rdquo;, you ask. Well, it&rsquo;s all part of my learning process. I also wanted to understand how C2 frameworks work and how zig can be used for offensive tooling.
There are lots of C2 frameworks out there and each has its own quirks and uniqueness. I happened to settle on Mythic. Mythic supports agents written in any language.<div class=read-more-link><a href=/reflections-on-writing-a-mythic-c2-agent-in-zig/>Read Moreâ€¦</a></div></article><article class=post><h1 class=post-title><a href=https://pop-ecx.github.io/writing-a-yara-parser/>Writing a Yara Parser</a></h1><time datetime=2025-06-18T12:56:07+0300 class=post-date>Wed, Jun 18, 2025</time><br>It&rsquo;s been a while since I wrote yara rules. In fact, the last time I did, I was still using vscode. I needed now to write one. So I chose to look at one of my local yara rules repo. Opened it in nvim and &mldr; no syntax highlighting.
Easy fix though. Treesitter is what provides highlighting for my setup, so I did :TSInstall yara. Damn!! No yara parser. That meant I had to write a custom one.<div class=read-more-link><a href=/writing-a-yara-parser/>Read Moreâ€¦</a></div></article><article class=post><h1 class=post-title><a href=https://pop-ecx.github.io/chaos-cryptography/>Chaos Cryptography</a></h1><time datetime=2025-05-27T13:13:29+0300 class=post-date>Tue, May 27, 2025</time><br><p><img src=hero.jpg alt=hero></p><blockquote><p>This article was originally published on section.io, May 2022</p></blockquote><p>Chaos theory is a branch of mathematics that deals with studying non-linear dynamical systems that exhibit sensitivity to initial conditions. Chaotic conditions exist in nature. A decent and typical example of such is the weather.</p><div class=read-more-link><a href=/chaos-cryptography/>Read Moreâ€¦</a></div></article><article class=post><h1 class=post-title><a href=https://pop-ecx.github.io/quantum-key-distribution/>Quantum Key Distribution</a></h1><time datetime=2025-05-23T22:23:09+0300 class=post-date>Fri, May 23, 2025</time><br><p><img src=hero.jpg alt=hero></p><blockquote><p>This article was originally published on section.io, February 2022</p></blockquote><p>Quantum key distribution (QKD) is an advanced sub-disciplines of quantum information technology. It aims at coming up with novel and sophisticated methods of securely exchanging cryptographic keys by use of basic quantum mechanical concepts such as entanglement and measurement.</p><div class=read-more-link><a href=/quantum-key-distribution/>Read Moreâ€¦</a></div></article><article class=post><h1 class=post-title><a href=https://pop-ecx.github.io/clearfake-2/>Clearfake 2: We now have Lumma</a></h1><time datetime=2025-04-09T12:11:34+0300 class=post-date>Wed, Apr 9, 2025</time><br>I had previously written about my cutting up of clearfake which you can find here.
Quick recap:
We deobfuscated the powershell obtained from a fake browser update prompt. The code executed base64 encoded command with window style hidden option. The command downloaded a data.zip file. Now, the zip file is extracted, an exe is sought inside the contents and executed. Here is the code responsible for that: The zip file contains 4 files:<div class=read-more-link><a href=/clearfake-2/>Read Moreâ€¦</a></div></article><article class=post><h1 class=post-title><a href=https://pop-ecx.github.io/security-slips/>Security Slips: The Day I Ran Unknown Code</a></h1><time datetime=2025-03-28T13:17:54+0300 class=post-date>Fri, Mar 28, 2025</time><br>On March 25th 2025, Troy Hunt, haveibeenpwned&rsquo;s author, published in his blog about how a sneaky phishing lure got hold of his mailing list. This interesting read made me reminisce about how, not so long ago, I almost fell for a similar thing, albeit mine was not so sophisticated.
January 2nd 2025, 12 p.m EAT, I had just gotten home from a lengthy holiday. Being super tired I booted up my Latitude to check on a few things.<div class=read-more-link><a href=/security-slips/>Read Moreâ€¦</a></div></article><article class=post><h1 class=post-title><a href=https://pop-ecx.github.io/secure-development/>Secure Development in Neovim using Snyk</a></h1><time datetime=2025-03-19T09:39:27+0300 class=post-date>Wed, Mar 19, 2025</time><br>In my previous post I talked about how you can use snyk in your editor as you code and even added snyk-ls as a must have. I had a bit of a tough time finding the correct configuration to achieve this using Neovim. Perhaps you are, right now, on the same path as myself last year. Luckily for you, I gotchu.
Before proceeding, make sure you have a snyk account and activate snyk code.<div class=read-more-link><a href=/secure-development/>Read Moreâ€¦</a></div></article><article class=post><h1 class=post-title><a href=https://pop-ecx.github.io/nvim-dev/>Nvim Dev</a></h1><time datetime=2025-03-17T11:27:33+0300 class=post-date>Mon, Mar 17, 2025</time><br>Here is a quick list of my Neovim setup for dev work. This includes plugins, LSPs and some handy keymaps.
Plugins Telescope - Fuzzy find files quickly. No need for filetree with this one. Harpoon - Mark frequently visited files and get to them blazingly fast. Mason - This helps in installing language servers. Make sure you have mason-lspconfig.nvim and nvim-lspconfig. nvim-cmp - For completions. Make sure to also get Luasnip, cmp_luasnip, friendly-snippets and nvim-cmp-lsp.<div class=read-more-link><a href=/nvim-dev/>Read Moreâ€¦</a></div></article><article class=post><h1 class=post-title><a href=https://pop-ecx.github.io/clearfake/>Clearfake Malware Analysis</a></h1><time datetime=2025-03-03T11:10:51+0300 class=post-date>Mon, Mar 3, 2025</time><br>A while ago (around 7 months ago), I had obtained, through a friend, a sample of clearfake malware that was wrecking havoc in one of his friend&rsquo;s servers.
This post is about analysis I had done. I have been procrastinating a lot on writing it, so here it goes&mldr;
Below is a screenshot of the infection method it uses, a notification to update your browser by running some powershell.
I clicked copy and pasted it in Neovim.<div class=read-more-link><a href=/clearfake/>Read Moreâ€¦</a></div></article><article class=post><h1 class=post-title><a href=https://pop-ecx.github.io/purplefox-analysis/>Purplefox Analysis</a></h1><time datetime=2025-02-25T11:03:11+0300 class=post-date>Tue, Feb 25, 2025</time><br>Originally written Thu, Jun 15, 2023
A couple of months ago, I came across an intriguing .tmp file that was sent to me. The sender mentioned that their antivirus software had flagged and caught the file on their computer. Naturally, I decided to investigate further. Although the file was labeled as a .tmp file, running it through a file utility revealed that it was actually an MSI (Microsoft Software Installer) file.<div class=read-more-link><a href=/purplefox-analysis/>Read Moreâ€¦</a></div></article><article class=post><h1 class=post-title><a href=https://pop-ecx.github.io/about/>About</a></h1><time datetime=2025-02-24T19:35:33+0300 class=post-date>Mon, Feb 24, 2025</time><br>Hey, I&rsquo;m Ollieâ€”a cybersecurity pro and dev diving deep into Zig, Lua, and Neovim. I tinker with low-level programming, build custom tooling, and explore malware analysis.
This blog is where I share insights, experiments, and lessons learnedâ€”whether itâ€™s writing an LSP, reverse-engineering binaries, or customizing Neovim for cybersecurity workflows.
If youâ€™re into efficient code, security research, or just making tools work your way, youâ€™re in the right place.
ðŸ›  Languages & Tools: Zig, Lua, Python, YARA, Sigma, Neovim<div class=read-more-link><a href=/about/>Read Moreâ€¦</a></div></article><article class=post><h1 class=post-title><a href=https://pop-ecx.github.io/posts/>Posts</a></h1><time datetime=2025-02-24T13:15:42+0300 class=post-date>Mon, Feb 24, 2025</time><br>Writing Custom Wazuh Rules - Jan 22, 2026 Safety in Zig: How Debug Allocator Works - Jan 6, 2026 Painless Guide to Linux in-Memory Execution - Dec 4, 2025 Zig as a drop in C build systems replacement - Oct 21, 2025 Pack to the Future: Obfuscating My C2 Agent - Sep 9, 2025 Reflections on writing a mythic C2 agent in zig - Jul 14, 2025 Writing a yara parser - Jun 18, 2025 Chaos Cryptography - May 27, 2025 Quantum Key Distribution - May 23, 2025 clearfake 2: We now have lumma - Apr 9, 2025 Security slips: The day i ran unknown code - Mar 28, 2025 Secure development in nvim using snyk - Mar 19, 2025 Nvim for devs - Mar 17, 2025 Clearfake analysis pt 1 - Mar 3, 2025 Purplefox msi rootkit analysis - Feb 25, 2025</article></div></main></body></html>